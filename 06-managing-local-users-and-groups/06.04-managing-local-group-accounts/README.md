## Цели

После завершения этого раздела учащиеся смогут создавать, изменять и удалять локальные учетные записи групп.

## Управление локальными группами

Чтобы добавить пользователя в группу, необходимо ее создать. Для управления локальными группами доступно несколько утилит командной строки.

**Создание групп из командной строки:**

* Создать группы можно с помощью команды `groupadd`. При создании групп команда `groupadd` без опций использует следующий доступный идентификатор группы (GID) из диапазона, указанного в файле **/etc/login.defs**.
* Опция `-g` указывает конкретный GID для группы.

    ```
    [user01@host ~]$ sudo groupadd -g 10000 group01
    [user01@host ~]$ tail /etc/group
    ...output omitted...
    group01:x:10000:
    ```

    <details>
    <summary>Примечание</summary>

    Так как частные группы пользователей (GID больше 1000) создаются автоматически, как правило, рекомендуется выделить диапазон GID для дополнительных групп. Чтобы избежать конфликтов с системной группой (GID 0–999), рекомендуется использовать более высокий диапазон.
    </details>

* Опция `-r` создает системную группу, используя GID из допустимого диапазона системных номеров GID, указанных в файле **/etc/login.defs**. Элементы конфигурации SYS_GID_MIN и SYS_GID_MAX в файле **/etc/login.defs** определяют диапазон системных GID.

    ```
    [user01@host ~]$ sudo groupadd -r group02
    [user01@host ~]$ tail /etc/group
    ...output omitted...
    group01:x:10000:
    group02:x:988:
    ```

**Изменение существующих групп из командной строки:**

* Команда groupmod изменяет свойства существующей группы. Опция `-n` указывает новое имя для группы.

    ```
    [user01@host ~]$ sudo groupmod -n group0022 group02
    [user01@host ~]$ tail /etc/group
    ...output omitted...
    group0022:x:988:
    ```

    Обратите внимание, что имя группы меняется с group02 на group0022.

* Опция `-g` указывает новый GID.

    ```
    [user01@host ~]$ sudo groupmod -g 20000 group0022
    [user01@host ~]$ tail /etc/group
    ...output omitted...
    group0022:x:20000:
    ```

    Обратите внимание, что GID меняется с 988 на 20000.

**Удаление групп из командной строки:**

* Команда `groupdel` удаляет группы.

    ```
    [user01@host ~]$ sudo groupdel group0022
    ```

    <details>
    <summary>Примечание</summary>

    Группу невозможно удалить, если она является основной группой хотя бы одного из существующих пользователей. Как и в случае с `userdel`, проверьте все файловые системы, чтобы убедиться, что группе не принадлежат никакие файлы в системе.
    </details>

**Изменение принадлежности к группе из командной строки:**

* Принадлежность к группе контролируется средствами управления пользователями. Используйте команду `usermod -g`, чтобы изменить основную группу пользователя.

    ```
    [user01@host ~]$ id user02
    uid=1006(user02) gid=1008(user02) groups=1008(user02)
    [user01@host ~]$ sudo usermod -g group01 user02
    [user01@host ~]$ id user02
    uid=1006(user02) gid=10000(group01) groups=10000(group01)
    ```

* Используйте команду `usermod -aG`, чтобы добавить пользователя в дополнительную группу.

    ```
    [user01@host ~]$ id user03
    uid=1007(user03) gid=1009(user03) groups=1009(user03)
    [user01@host ~]$ sudo usermod -aG group01 user03
    [user01@host ~]$ id user03
    uid=1007(user03) gid=1009(user03) groups=1009(user03),10000(group01)
    ```

    <details>
    <summary>Важно</summary>

    Использование опции `-a` активирует режим дополнения для функции `usermod`. Без опции `-a` пользователь будет удален из всех текущих дополнительных групп, которые не включены в список опции `-G`.
    </details>

